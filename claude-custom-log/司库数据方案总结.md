# 司库管理系统数据分类方案总结

## 一、项目背景

司库管理系统包含 **218张数据表**，需要对这些数据进行分类整理，明确哪些数据由**数据湖**处理，哪些由**司库业务中台**处理，以实现数据资产的合理分工和高效利用。

---

## 二、分类结果

### 2.1 数据分布概览

| 分类 | 表数量 | 占比 | 处理平台 | 核心特点 |
|------|--------|------|----------|----------|
| **公共数据** | 67张 | 30.7% | 数据湖 | 财务可复用、标准化程度高 |
| **司库特有数据** | 151张 | 69.3% | 业务中台 | 业务逻辑复杂、实时性要求高 |

### 2.2 公共数据明细（数据湖处理）

| 模块 | 表数量 | 主要内容 |
|------|--------|----------|
| 应收应付 | 23张 | 客户应收单、供应商应付单、收付款、核销 |
| 坏账计提 | 9张 | 计提规则、计提比率、计提明细 |
| 发票管理 | 9张 | 发票信息、开票申请、发票关联 |
| 银行对账 | 8张 | 银行对账单、余额调节、对账记录 |
| 组织配置 | 7张 | 组织架构、利率配置、融资机构 |
| 其他公共 | 11张 | 银行余额、支付确认、结算信息 |

### 2.3 司库特有数据明细（业务中台处理）

| 模块 | 表数量 | 主要内容 |
|------|--------|----------|
| 票据管理 | 36张 | 出票、背书、贴现、托收、质押、承兑 |
| 贷款管理 | 44张 | 贷款合同、放款、还款、付息、展期、委托贷款 |
| 授信管理 | 17张 | 授信协议、额度调整、占用释放、执行明细 |
| 担保管理 | 20张 | 担保合同、抵押、质押、保证、反担保 |
| 账户管理 | 12张 | 开户申请、账户变更、低效账户处理 |
| 保函管理 | 6张 | 开函申请、收函登记、开函台账 |
| 其他业务 | 16张 | 债券发行、融资上报、电票业务、风险管理 |

---

## 三、技术方案对比

| 维度 | 数据湖 | 业务中台 |
|------|--------|----------|
| **数据特点** | 标准化、可复用 | 业务化、强逻辑 |
| **处理模式** | 批处理 | 实时处理 |
| **时效性** | T+1 | 秒级/分钟级 |
| **计算引擎** | Spark | Flink |
| **存储方案** | Hive/Iceberg | MySQL/TiDB + Redis |
| **同步方式** | DataX增量/全量 | CDC实时 |
| **分层架构** | ODS→DWD→DWS→ADS | 贴源→明细→聚合→服务 |

---

## 四、分层架构设计

### 4.1 数据湖分层

```
应用层(ADS) ──── 财务报表、分析指标、数据服务API
    ▲
汇总层(DWS) ──── 应收汇总、应付汇总、发票统计、对账汇总
    ▲
明细层(DWD) ──── 应收明细宽表、应付明细宽表、发票明细宽表
    ▲
贴源层(ODS) ──── ar_*、ap_*、arap_*、sscivm_*、gl_*
```

### 4.2 业务中台分层

```
业务服务层 ──── 票据中心、贷款中心、授信中心、担保中心API
    ▲
业务聚合层 ──── 票据全景、贷款全景、授信全景、担保全景
    ▲
业务明细层 ──── 票据事件流、贷款交易流水、授信变动记录
    ▲
业务贴源层 ──── fbm_*、cdmc_*、ccc_*、gpmc_*、bgm_*、tam_*
```

---

## 五、核心能力分工

### 5.1 数据湖核心能力

| 能力 | 说明 |
|------|------|
| 财务数据标准化 | 统一应收应付数据标准，支持财务系统复用 |
| 账龄分析 | 自动计算应收账款账龄分布 |
| 坏账计提 | 按规则自动计算坏账准备金 |
| 对账处理 | 银企对账、余额调节、差异分析 |
| 财务报表 | 为财务报表提供基础数据支撑 |

### 5.2 业务中台核心能力

| 能力 | 说明 |
|------|------|
| 额度实时控制 | 授信额度占用、释放的实时计算 |
| 业务流程引擎 | 票据流转、贷款生命周期的业务规则处理 |
| 风险实时预警 | 逾期预警、到期预警、额度预警 |
| 版本管理 | 合同、担保等业务数据的版本追溯 |
| 状态机管理 | 业务状态流转的实时跟踪 |

---

## 六、关键指标分工

| 指标类型 | 数据湖计算 | 业务中台计算 |
|----------|-----------|-------------|
| 周转指标 | 应收/应付周转率 | - |
| 余额指标 | 日均余额、月均余额 | 实时余额 |
| 账龄指标 | 1-30天、31-60天、60天以上 | - |
| 额度指标 | - | 授信使用率、可用额度 |
| 风险指标 | 坏账率 | 逾期率、集中度 |
| 预警指标 | - | 到期预警、额度预警 |

---

## 七、数据交互机制

### 7.1 交互场景

| 场景 | 数据流向 | 说明 |
|------|----------|------|
| 利率获取 | 数据湖→中台 | 中台从数据湖获取利率基准 |
| 信用评估 | 数据湖→中台 | 中台获取账龄、坏账数据评估信用 |
| 业务回流 | 中台→数据湖 | 授信使用、贷款余额等数据回流 |
| 报表汇总 | 双向 | 数据湖汇总中台数据生成报表 |

### 7.2 一致性保障

- **分布式事务**：Seata AT模式
- **数据对账**：T+1全量对账 + 实时校验
- **血缘追踪**：全链路数据血缘管理

---

## 八、实施建议

### 8.1 实施阶段

| 阶段 | 内容 | 产出 |
|------|------|------|
| **第一阶段** | 数据分类确认 | 确认67张公共表、151张业务表清单 |
| **第二阶段** | 数据湖建设 | 完成公共数据四层模型建设 |
| **第三阶段** | 中台建设 | 完成业务数据实时处理能力 |
| **第四阶段** | 对接联调 | 完成数据服务对接和一致性验证 |

### 8.2 关键成功因素

1. **明确边界**：严格按分类原则划分数据归属
2. **统一标准**：建立数据标准和接口规范
3. **实时协同**：确保数据湖与中台的数据一致性
4. **持续优化**：根据业务发展迭代分类方案

---

## 九、预期收益

| 收益项 | 说明 |
|--------|------|
| **避免重复建设** | 公共数据统一加工，多系统复用 |
| **业务快速响应** | 司库业务实时计算，秒级响应 |
| **数据质量提升** | 统一数据标准，保障数据一致性 |
| **运维成本降低** | 合理分工，减少系统耦合 |

---

## 十、附件清单

| 文档名称 | 说明 |
|----------|------|
| 司库数据分类方案.md | 完整分类清单和技术方案 |
| 司库数据架构总览.md | 整体架构图和分层设计 |
| 司库数据方案总结.md | 本文档（方案总结） |

---

**文档版本**：V1.0
**编制日期**：2025年12月26日
