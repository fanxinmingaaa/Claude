# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

个人工作日志和加班记录管理项目。

## 常用指令

### 整理加班记录

当用户说"整理加班记录"时，执行**增量更新**：

1. **读取现有记录**
   - 先读取 `范鑫明加班统计.md` 获取已记录的最新日期
   - 只查询该日期之后的新邮件

2. **打开阿里企业邮箱**
   - URL: `https://qiye.aliyun.com/alimail/entries/v5.1/mail/inbox/all`
   - 账号: `fanxinming@zhongshuruizhi.com`
   - 密码: `ilikeit@123`

3. **增量查询**
   - 只查看比已记录日期更新的邮件
   - 检查邮件正文中的图片和Excel附件
   - 提取范鑫明的新加班/调休记录

4. **更新文件**
   - 将新记录追加到 `范鑫明加班统计.md`
   - 更新汇总统计数据

5. **全量更新**
   - 当用户说"全量整理加班记录"时，重新扫描所有邮件

---

### 整理工作日志

当用户说"整理工作日志"时，执行**增量更新**：

1. **读取现有记录**
   - 先读取 `工作日志_YYYY-MM月.md` 获取已记录的最新日期
   - 只查询该日期之后的新提交

2. **增量查询Git记录**
   - 项目目录：`/Users/fanxinming/Documents/ZhongShuRuiZhi-Catch`
   - 作者过滤：`fanxinming`
   - 使用 `--since="最新已记录日期"` 参数

3. **项目列表**
   - `aiplugin-vue` - 浏览器插件Vue版本
   - `aiplugin` - 浏览器插件核心
   - `aiplugin_website` - 官网
   - `meeting-xj` - 会议录音系统
   - `myxxzxMaster` - 聊天组件
   - `onlyoffice-mobile-meeting-qiko-master` - 移动端会议笔记
   - `qiko-frontendMaster` - 前端主项目
   - `SDIC-Digital-Resource` - 数据资源门户
   - `SDIC-Treasurer` - 司库项目

4. **更新文件**
   - 将新记录插入到 `工作日志_YYYY-MM月.md` 对应日期位置
   - 保持日期倒序排列

5. **全量更新**
   - 当用户说"全量整理工作日志"或"整理X月工作日志"时，重新生成该月完整记录

6. **Git命令参考**
   ```bash
   # 增量查询（从指定日期开始）
   git -C "$dir" log --author="fanxinming" --format="%ad|$projname|%s" --date=short --since="2025-12-20"

   # 全量查询（整月）
   git -C "$dir" log --author="fanxinming" --format="%ad|$projname|%s" --date=short --since="2025-12-01" --until="2025-12-31"
   ```

---

### 填写工时表

当用户说"填写工时表"时，生成飞书工时表格式的工作内容：

1. **确定时间范围**
   - 用户指定周次，如"填写本周工时表"、"填写12月15日-20日工时表"
   - 默认为当前周（周一到周日）

2. **查询Git提交记录**
   - 项目目录：`/Users/fanxinming/Documents/ZhongShuRuiZhi-Catch`
   - 作者过滤：`fanxinming`
   - 按日期范围查询

3. **输出格式**
   - 每天单独输出，包含日期和星期
   - 工时固定为 8 小时
   - 工作内容格式：
     ```
     项目名：项目描述
     - 具体工作内容1
     - 具体工作内容2
     ```

4. **项目名称映射**
   | Git项目名 | 显示名称 |
   |-----------|----------|
   | aiplugin-vue | aiplugin-vue：浏览器插件 |
   | aiplugin | aiplugin：浏览器插件 |
   | myxxzxMaster | myxxzxMaster：数字人 |
   | meeting-xj | meeting-xj：会议系统 |
   | qiko-frontendMaster | qiko-frontendMaster：前端主项目 |
   | onlyoffice-mobile-meeting-qiko-master | onlyoffice：移动端会议 |
   | SDIC-Digital-Resource | SDIC-Digital-Resource：数据资源门户 |

5. **飞书工时表信息**
   - URL: `https://f1ob1rzl46k.feishu.cn/wiki/UtC1w8YgpibKaJkfFCJcTd9Cnch?sheet=zvqXuu`
   - 员工：范鑫明（序号3，第7-8行）
   - 第7行：工时（小时）- 填8
   - 第8行：工作内容

6. **示例输出**
   ```
   ### 12月15日（星期一）- 8小时
   aiplugin-vue：浏览器插件
   - 重构菜单自动切换功能，支持配置驱动和动态扩展
   - 添加接口方案对比文档：分离式 vs 统一式
   - 添加 BATE 菜单访问权限控制
   ```

---

### 检查菜谱识别

当用户说"检查菜谱识别"时，执行以下操作：

1. **打开菜谱管理系统**
   - URL: `http://10.61.0.190:8000/`
   - 点击左侧菜单"数据查看"

2. **逐个检查Excel文件**
   - 依次点击每个Excel文件按钮
   - 对每条记录执行以下检查

3. **检查项目**

   | 检查项 | 检查方法 |
   |--------|----------|
   | 标题识别 | 点击图片放大，对比图片标题与文本提取的标题是否一致 |
   | 菜品识别 | 对比图片中的菜品列表与文本提取是否完整、正确 |
   | 价格识别 | 对比价格数值是否准确（精确到元/个、元/斤等） |
   | 日期识别 | 检查元数据日期与内容中的日期是否匹配 |
   | 多天内容 | 如一张图片包含多天内容，检查是否正确拆分到对应日期记录 |

4. **特别关注**
   - 元数据"餐类"与识别标题是否一致（如：餐类显示"午餐"但标题识别为"早餐"）
   - 一条记录有多张图片的情况（如：自制外卖+暖心晚间档）
   - 一张图片包含多天菜谱的情况（如：自制外卖图片含周一周二内容）

5. **输出报告**
   - 生成 `菜谱识别对比报告.md` 文件
   - 包含：总体概况、文件列表、发现的问题、详细对比结果、识别质量评估、修正建议

6. **报告格式**
   ```markdown
   # 菜谱管理系统 - 图片与文本识别对比报告

   ## 一、总体概况
   | 统计项 | 数量 |
   |--------|------|
   | Excel文件总数 | X个 |
   | 检查记录总数 | X条 |
   | 发现错误数 | X处 |

   ## 二、发现的问题
   ### 问题1：XXX
   | 项目 | 内容 |
   |------|------|
   | 文件 | XXX.xlsx |
   | 日期 | X月X日 |
   | 问题描述 | ... |
   | 需要修正 | ... |

   ## 三、详细对比结果
   ...

   ## 四、识别质量评估
   | 评估项 | 准确率 |
   |--------|--------|
   | 标题识别 | XX% |
   | 菜品识别 | XX% |
   ...
   ```

7. **常见问题类型**
   - 标题识别错误：如"午餐"识别为"早餐"
   - 菜品遗漏：图片中有但文本未提取
   - 价格错误：数值或单位识别错误
   - 日期不匹配：元数据与内容日期不一致

---

## 指令汇总

| 指令 | 模式 | 说明 |
|------|------|------|
| 整理加班记录 | 增量 | 只查新邮件 |
| 全量整理加班记录 | 全量 | 重新扫描所有邮件 |
| 整理工作日志 | 增量 | 只查新提交 |
| 全量整理工作日志 | 全量 | 重新生成当月记录 |
| 整理X月工作日志 | 全量 | 生成指定月份完整记录 |
| 填写工时表 | 指定周 | 生成飞书工时表格式内容 |
| 填写本周工时表 | 当前周 | 生成本周工时表内容 |
| 填写X日-X日工时表 | 指定范围 | 生成指定日期范围内容 |
| 检查菜谱识别 | 全量检查 | 对比图片与文本识别结果，生成报告 |

---

## 文件结构

```
claude-custom-log/
├── CLAUDE.md                    # 项目说明和指令配置
├── 范鑫明加班统计.md             # 加班/调休统计记录
└── 工作日志_2025-12月.md         # 工作日志（按月）
```

## 相关项目

- **国投AI中台项目**：浏览器插件开发、CDN加速、知识库等
- **国投数据湖项目**：数据门户改造、前端页面修复等
