# 司库管理系统数据架构总览

## 一、整体架构图

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                              司库管理系统                                                     │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐           │
│  │   票据系统   │ │   贷款系统   │ │   授信系统   │ │   担保系统   │ │   保函系统   │ │   账户系统   │           │
│  │  (36张表)   │ │  (44张表)   │ │  (17张表)   │ │  (20张表)   │ │  (6张表)    │ │  (12张表)   │           │
│  └──────┬──────┘ └──────┬──────┘ └──────┬──────┘ └──────┬──────┘ └──────┬──────┘ └──────┬──────┘           │
│         │               │               │               │               │               │                   │
│         └───────────────┴───────────────┴───────┬───────┴───────────────┴───────────────┘                   │
│                                                 │                                                            │
│  ┌────────────────────────────────────┐         │         ┌────────────────────────────────────┐            │
│  │         财务核算系统                 │         │         │         基础数据                    │            │
│  │  ┌─────────┐ ┌─────────┐          │         │         │  ┌─────────┐ ┌─────────┐          │            │
│  │  │应收应付  │ │  发票   │           │         │         │  │  组织   │ │  利率   │           │            │
│  │  │(23张表) │ │(9张表)  │           │         │         │  │(2张表)  │ │(1张表)  │           │            │
│  │  └─────────┘ └─────────┘          │         │         │  └─────────┘ └─────────┘          │            │
│  │  ┌─────────┐ ┌─────────┐          │         │         │  ┌─────────┐ ┌─────────┐          │            │
│  │  │坏账计提  │ │银行对账  │           │         │         │  │融资机构  │ │  其他   │           │            │
│  │  │(9张表)  │ │(8张表)  │           │         │         │  │(3张表)  │ │(12张表) │           │            │
│  │  └─────────┘ └─────────┘          │         │         │  └─────────┘ └─────────┘          │            │
│  └────────────────┬───────────────────┘         │         └────────────────┬───────────────────┘            │
│                   │                             │                          │                                │
└───────────────────┼─────────────────────────────┼──────────────────────────┼────────────────────────────────┘
                    │                             │                          │
                    │     ┌───────────────────────┴───────────────────────┐  │
                    │     │                                               │  │
                    ▼     ▼                                               ▼  ▼
┌─────────────────────────────────────────┐       ┌─────────────────────────────────────────┐
│                                         │       │                                         │
│           数 据 采 集 层                 │       │           数 据 采 集 层                 │
│                                         │       │                                         │
│  ┌─────────────────────────────────┐   │       │  ┌─────────────────────────────────┐   │
│  │     CDC 实时采集 (Debezium)      │   │       │  │    DataX 批量采集 + CDC          │   │
│  │     业务事件流 → Kafka           │   │       │  │    增量/全量同步                  │   │
│  └─────────────────────────────────┘   │       │  └─────────────────────────────────┘   │
│                                         │       │                                         │
└──────────────────┬──────────────────────┘       └──────────────────┬──────────────────────┘
                   │                                                  │
                   │  司库特有数据 (151张表)              公共数据 (67张表)  │
                   │                                                  │
                   ▼                                                  ▼
┌─────────────────────────────────────────┐       ┌─────────────────────────────────────────┐
│                                         │       │                                         │
│        司 库 业 务 中 台                 │       │            数 据 湖                      │
│                                         │       │                                         │
│  ┌─────────────────────────────────┐   │       │  ┌─────────────────────────────────┐   │
│  │          业务服务层              │   │       │  │          应用层 (ADS)            │   │
│  │  ┌───────┐┌───────┐┌───────┐   │   │       │  │  财务报表 │ 分析指标 │ 数据服务   │   │
│  │  │票据中心││贷款中心││授信中心│   │   │       │  └─────────────────────────────────┘   │
│  │  └───────┘└───────┘└───────┘   │   │       │                    ▲                    │
│  │  ┌───────┐┌───────┐┌───────┐   │   │       │  ┌─────────────────────────────────┐   │
│  │  │担保中心││保函中心││账户中心│   │   │       │  │          汇总层 (DWS)            │   │
│  │  └───────┘└───────┘└───────┘   │   │       │  │  应收汇总 │ 应付汇总 │ 发票统计   │   │
│  └─────────────────────────────────┘   │       │  └─────────────────────────────────┘   │
│                    ▲                    │       │                    ▲                    │
│  ┌─────────────────────────────────┐   │       │  ┌─────────────────────────────────┐   │
│  │          业务聚合层              │   │       │  │          明细层 (DWD)            │   │
│  │  票据全景│贷款全景│授信全景      │   │       │  │  应收明细 │ 应付明细 │ 发票明细   │   │
│  │  担保全景│风险全景│额度全景      │   │       │  └─────────────────────────────────┘   │
│  └─────────────────────────────────┘   │       │                    ▲                    │
│                    ▲                    │       │  ┌─────────────────────────────────┐   │
│  ┌─────────────────────────────────┐   │       │  │          贴源层 (ODS)            │   │
│  │          业务明细层              │   │       │  │  ar_* │ ap_* │ arap_* │ sscivm_*│   │
│  │  票据事件│贷款流水│授信变动      │   │       │  │  gl_* │ org_* │ fi_* │ tmpub_*  │   │
│  │  担保变动│账户变动│费用明细      │   │       │  └─────────────────────────────────┘   │
│  └─────────────────────────────────┘   │       │                                         │
│                    ▲                    │       │          技术组件                        │
│  ┌─────────────────────────────────┐   │       │  ┌─────────────────────────────────┐   │
│  │          业务贴源层              │   │       │  │  存储: Hive / Iceberg            │   │
│  │  fbm_* │ cdmc_* │ ccc_*         │   │       │  │  计算: Spark                     │   │
│  │  gpmc_* │ bgm_* │ tam_*         │   │       │  │  调度: DolphinScheduler          │   │
│  └─────────────────────────────────┘   │       │  └─────────────────────────────────┘   │
│                                         │       │                                         │
│          技术组件                        │       └──────────────────┬──────────────────────┘
│  ┌─────────────────────────────────┐   │                           │
│  │  实时计算: Flink                 │   │                           │
│  │  消息队列: Kafka                 │   │                           │
│  │  状态缓存: Redis                 │   │                           │
│  │  业务存储: MySQL / TiDB          │   │                           │
│  │  规则引擎: Drools                │   │                           │
│  └─────────────────────────────────┘   │                           │
│                                         │                           │
└──────────────────┬──────────────────────┘                           │
                   │                                                  │
                   │              数 据 交 互 层                       │
                   │  ┌───────────────────────────────────────────┐  │
                   │  │                                           │  │
                   └──┤  ┌─────────────────────────────────────┐  ├──┘
                      │  │         数据服务总线                  │  │
                      │  │                                     │  │
                      │  │  ┌───────────┐    ┌───────────┐    │  │
                      │  │  │ 业务数据API│◀──▶│ 公共数据API│    │  │
                      │  │  └───────────┘    └───────────┘    │  │
                      │  │         │              │           │  │
                      │  │         ▼              ▼           │  │
                      │  │  ┌─────────────────────────────┐   │  │
                      │  │  │       数据一致性保障         │   │  │
                      │  │  │  • 分布式事务 (Seata)       │   │  │
                      │  │  │  • T+1 全量对账             │   │  │
                      │  │  │  • 数据血缘追踪             │   │  │
                      │  │  └─────────────────────────────┘   │  │
                      │  └─────────────────────────────────────┘  │
                      │                                           │
                      └───────────────────────────────────────────┘
                                          │
                                          ▼
                   ┌──────────────────────────────────────────────────┐
                   │                    应用层                         │
                   │                                                  │
                   │  ┌────────────┐ ┌────────────┐ ┌────────────┐   │
                   │  │  管理驾驶舱  │ │  业务门户   │ │  移动端APP  │   │
                   │  └────────────┘ └────────────┘ └────────────┘   │
                   │                                                  │
                   │  ┌────────────┐ ┌────────────┐ ┌────────────┐   │
                   │  │  财务报表   │ │  风险预警   │ │  决策支持   │   │
                   │  └────────────┘ └────────────┘ └────────────┘   │
                   │                                                  │
                   └──────────────────────────────────────────────────┘
```

---

## 二、数据流转全景图

```
                                    司库业务系统 (218张表)
                                           │
                    ┌──────────────────────┴──────────────────────┐
                    │                                             │
                    ▼                                             ▼
        ┌───────────────────────┐                   ┌───────────────────────┐
        │   司库特有数据 (151张)  │                   │    公共数据 (67张)     │
        │                       │                   │                       │
        │  • 票据管理 (36)      │                   │  • 应收应付 (23)      │
        │  • 贷款管理 (44)      │                   │  • 坏账计提 (9)       │
        │  • 授信管理 (17)      │                   │  • 发票管理 (9)       │
        │  • 担保管理 (20)      │                   │  • 银行对账 (8)       │
        │  • 保函管理 (6)       │                   │  • 组织配置 (7)       │
        │  • 账户管理 (12)      │                   │  • 其他公共 (11)      │
        │  • 其他业务 (16)      │                   │                       │
        └───────────┬───────────┘                   └───────────┬───────────┘
                    │                                             │
                    │ CDC实时                              DataX批量 │
                    │ (秒级)                                (T+1)  │
                    ▼                                             ▼
        ┌───────────────────────┐                   ┌───────────────────────┐
        │                       │                   │                       │
        │    司库业务中台        │◀─────────────────▶│      数据湖           │
        │                       │    数据服务调用    │                       │
        │  ┌─────────────────┐ │                   │ ┌─────────────────┐  │
        │  │   Flink 实时    │ │                   │ │  Spark 批处理   │  │
        │  │   计算引擎      │ │                   │ │  计算引擎       │  │
        │  └─────────────────┘ │                   │ └─────────────────┘  │
        │          │           │                   │         │            │
        │          ▼           │                   │         ▼            │
        │  ┌─────────────────┐ │                   │ ┌─────────────────┐  │
        │  │ • 额度实时计算   │ │                   │ │ • 账龄分析      │  │
        │  │ • 风险实时预警   │ │                   │ │ • 坏账计提      │  │
        │  │ • 业务状态流转   │ │                   │ │ • 对账处理      │  │
        │  │ • 到期提醒      │ │                   │ │ • 报表汇总      │  │
        │  └─────────────────┘ │                   │ └─────────────────┘  │
        │          │           │                   │         │            │
        │          ▼           │                   │         ▼            │
        │  ┌─────────────────┐ │   业务结果回流    │ ┌─────────────────┐  │
        │  │  业务服务API    │─┼─────────────────▶│ │  数据服务API    │  │
        │  └─────────────────┘ │                   │ └─────────────────┘  │
        │                       │                   │                       │
        └───────────────────────┘                   └───────────────────────┘
                    │                                             │
                    └──────────────────┬──────────────────────────┘
                                       │
                                       ▼
                            ┌───────────────────────┐
                            │      统一数据服务      │
                            │                       │
                            │  • 管理驾驶舱         │
                            │  • 财务报表           │
                            │  • 风险监控           │
                            │  • 业务分析           │
                            └───────────────────────┘
```

---

## 三、模块职责划分图

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                         │
│                                    数 据 湖 (67张表)                                     │
│                                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │                              核心职责                                            │  │
│   │                                                                                 │  │
│   │   ✓ 财务数据标准化加工          ✓ 跨系统数据共享           ✓ 历史数据归档        │  │
│   │   ✓ 应收应付账龄分析            ✓ 坏账计提计算             ✓ 发票匹配校验        │  │
│   │   ✓ 银行余额对账                ✓ 财务报表数据准备         ✓ 组织主数据管理      │  │
│   │                                                                                 │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                         │
│   ┌───────────────┐ ┌───────────────┐ ┌───────────────┐ ┌───────────────┐              │
│   │  应收应付模块  │ │  发票管理模块  │ │  银行对账模块  │ │  基础配置模块  │              │
│   │    (32张)     │ │    (9张)      │ │    (8张)      │ │    (18张)     │              │
│   │               │ │               │ │               │ │               │              │
│   │ • 应收单      │ │ • 发票信息    │ │ • 银行对账单  │ │ • 组织架构    │              │
│   │ • 应付单      │ │ • 开票申请    │ │ • 余额调节    │ │ • 利率配置    │              │
│   │ • 收付款      │ │ • 发票关联    │ │ • 对账记录    │ │ • 机构信息    │              │
│   │ • 核销处理    │ │ • 凭证关系    │ │ • 账户关联    │ │ • 单据类型    │              │
│   │ • 坏账计提    │ │               │ │               │ │               │              │
│   └───────────────┘ └───────────────┘ └───────────────┘ └───────────────┘              │
│                                                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘

                                         │
                                         │ 数据服务
                                         ▼

┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                         │
│                               司库业务中台 (151张表)                                      │
│                                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│   │                              核心职责                                            │  │
│   │                                                                                 │  │
│   │   ✓ 票据全生命周期管理          ✓ 贷款业务流程处理         ✓ 授信额度实时控制    │  │
│   │   ✓ 担保物权管理                ✓ 保函开立与收函           ✓ 账户开销户管理      │  │
│   │   ✓ 业务规则引擎                ✓ 实时风险预警             ✓ 到期提醒服务        │  │
│   │                                                                                 │  │
│   └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                         │
│   ┌───────────────┐ ┌───────────────┐ ┌───────────────┐ ┌───────────────┐              │
│   │   票据模块     │ │   贷款模块     │ │   授信模块     │ │   担保模块     │              │
│   │    (36张)     │ │    (44张)     │ │    (17张)     │ │    (20张)     │              │
│   │               │ │               │ │               │ │               │              │
│   │ • 出票/承兑   │ │ • 贷款申请    │ │ • 授信协议    │ │ • 担保合同    │              │
│   │ • 背书/贴现   │ │ • 放款/还款   │ │ • 额度调整    │ │ • 抵押/质押   │              │
│   │ • 托收/兑付   │ │ • 付息/展期   │ │ • 占用/释放   │ │ • 保证/反担保 │              │
│   │ • 质押/流转   │ │ • 委托贷款    │ │ • 执行明细    │ │ • 集团担保    │              │
│   └───────────────┘ └───────────────┘ └───────────────┘ └───────────────┘              │
│                                                                                         │
│   ┌───────────────┐ ┌───────────────┐ ┌───────────────┐ ┌───────────────┐              │
│   │   保函模块     │ │   账户模块     │ │   债券模块     │ │   融资上报     │              │
│   │    (6张)      │ │    (12张)     │ │    (2张)      │ │    (5张)      │              │
│   │               │ │               │ │               │ │               │              │
│   │ • 开函申请    │ │ • 开户申请    │ │ • 债券发行    │ │ • 授信上报    │              │
│   │ • 收函登记    │ │ • 账户变更    │ │ • 本金兑付    │ │ • 融资上报    │              │
│   │ • 开函台账    │ │ • 低效账户    │ │               │ │               │              │
│   └───────────────┘ └───────────────┘ └───────────────┘ └───────────────┘              │
│                                                                                         │
│   ┌───────────────┐ ┌───────────────┐                                                  │
│   │   电票业务     │ │   风险管理     │                                                  │
│   │    (4张)      │ │    (2张)      │                                                  │
│   │               │ │               │                                                  │
│   │ • 电票状态    │ │ • 黑名单      │                                                  │
│   │ • 工资指令    │ │ • 关注合同    │                                                  │
│   └───────────────┘ └───────────────┘                                                  │
│                                                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 四、技术栈对比图

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                         │
│                                    技术栈对比                                            │
│                                                                                         │
├─────────────────────────────────────┬───────────────────────────────────────────────────┤
│                                     │                                                   │
│            数 据 湖                  │              司库业务中台                          │
│                                     │                                                   │
├─────────────────────────────────────┼───────────────────────────────────────────────────┤
│                                     │                                                   │
│   数据采集                           │   数据采集                                        │
│   ┌─────────────────────────────┐   │   ┌─────────────────────────────┐                │
│   │  DataX (批量)               │   │   │  Debezium CDC (实时)        │                │
│   │  • 全量同步: 每日凌晨        │   │   │  • 实时同步: 秒级延迟        │                │
│   │  • 增量同步: 每15分钟        │   │   │  • 事件驱动: Kafka          │                │
│   └─────────────────────────────┘   │   └─────────────────────────────┘                │
│                                     │                                                   │
├─────────────────────────────────────┼───────────────────────────────────────────────────┤
│                                     │                                                   │
│   计算引擎                           │   计算引擎                                        │
│   ┌─────────────────────────────┐   │   ┌─────────────────────────────┐                │
│   │  Apache Spark               │   │   │  Apache Flink               │                │
│   │  • 批处理为主               │   │   │  • 流处理为主               │                │
│   │  • 复杂SQL计算              │   │   │  • 实时状态计算             │                │
│   │  • 大规模数据处理            │   │   │  • 低延迟响应               │                │
│   └─────────────────────────────┘   │   └─────────────────────────────┘                │
│                                     │                                                   │
├─────────────────────────────────────┼───────────────────────────────────────────────────┤
│                                     │                                                   │
│   数据存储                           │   数据存储                                        │
│   ┌─────────────────────────────┐   │   ┌─────────────────────────────┐                │
│   │  Hive / Iceberg             │   │   │  MySQL / TiDB               │                │
│   │  • 海量数据存储              │   │   │  • 业务数据存储             │                │
│   │  • 列式存储优化              │   │   │  • 事务支持                 │                │
│   │  • 时间旅行查询              │   │   │                             │                │
│   └─────────────────────────────┘   │   │  Redis                      │                │
│                                     │   │  • 额度缓存                 │                │
│                                     │   │  • 状态缓存                 │                │
│                                     │   │  • 热点数据                 │                │
│                                     │   └─────────────────────────────┘                │
│                                     │                                                   │
├─────────────────────────────────────┼───────────────────────────────────────────────────┤
│                                     │                                                   │
│   任务调度                           │   任务调度                                        │
│   ┌─────────────────────────────┐   │   ┌─────────────────────────────┐                │
│   │  DolphinScheduler           │   │   │  XXL-Job                    │                │
│   │  • DAG任务编排               │   │   │  • 分布式任务调度            │                │
│   │  • 依赖管理                  │   │   │  • 业务定时任务              │                │
│   │  • 失败重试                  │   │   │  • 预警扫描任务              │                │
│   └─────────────────────────────┘   │   └─────────────────────────────┘                │
│                                     │                                                   │
├─────────────────────────────────────┼───────────────────────────────────────────────────┤
│                                     │                                                   │
│   数据质量                           │   业务规则                                        │
│   ┌─────────────────────────────┐   │   ┌─────────────────────────────┐                │
│   │  Great Expectations         │   │   │  Drools                     │                │
│   │  • 数据质量校验              │   │   │  • 业务规则引擎             │                │
│   │  • 异常数据告警              │   │   │  • 额度计算规则             │                │
│   │  • 数据血缘追踪              │   │   │  • 风险评估规则             │                │
│   └─────────────────────────────┘   │   └─────────────────────────────┘                │
│                                     │                                                   │
└─────────────────────────────────────┴───────────────────────────────────────────────────┘
```

---

## 五、数据分层对照图

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                         │
│                              分 层 架 构 对 照                                           │
│                                                                                         │
├─────────────────────────────────────┬───────────────────────────────────────────────────┤
│            数据湖分层                │           业务中台分层                             │
├─────────────────────────────────────┼───────────────────────────────────────────────────┤
│                                     │                                                   │
│   ┌─────────────────────────────┐   │   ┌─────────────────────────────┐                │
│   │        应用层 (ADS)          │   │   │        业务服务层            │                │
│   │                             │   │   │                             │                │
│   │  • 财务报表数据             │   │   │  • 票据中心API              │                │
│   │  • 分析指标服务             │   │   │  • 贷款中心API              │                │
│   │  • 跨系统数据API            │   │   │  • 授信中心API              │                │
│   │                             │   │   │  • 预警服务API              │                │
│   └─────────────────────────────┘   │   └─────────────────────────────┘                │
│              ▲                      │              ▲                                   │
│              │                      │              │                                   │
│   ┌─────────────────────────────┐   │   ┌─────────────────────────────┐                │
│   │        汇总层 (DWS)          │   │   │        业务聚合层            │                │
│   │                             │   │   │                             │                │
│   │  • 应收账款汇总             │   │   │  • 票据业务全景             │                │
│   │  • 应付账款汇总             │   │   │  • 贷款业务全景             │                │
│   │  • 银行余额汇总             │   │   │  • 授信额度全景             │                │
│   │  • 发票统计汇总             │   │   │  • 担保业务全景             │                │
│   └─────────────────────────────┘   │   └─────────────────────────────┘                │
│              ▲                      │              ▲                                   │
│              │                      │              │                                   │
│   ┌─────────────────────────────┐   │   ┌─────────────────────────────┐                │
│   │        明细层 (DWD)          │   │   │        业务明细层            │                │
│   │                             │   │   │                             │                │
│   │  • 应收明细宽表             │   │   │  • 票据事件流               │                │
│   │  • 应付明细宽表             │   │   │  • 贷款交易流水             │                │
│   │  • 发票明细宽表             │   │   │  • 授信变动记录             │                │
│   │  • 对账明细宽表             │   │   │  • 担保变动记录             │                │
│   └─────────────────────────────┘   │   └─────────────────────────────┘                │
│              ▲                      │              ▲                                   │
│              │                      │              │                                   │
│   ┌─────────────────────────────┐   │   ┌─────────────────────────────┐                │
│   │        贴源层 (ODS)          │   │   │        业务贴源层            │                │
│   │                             │   │   │                             │                │
│   │  • ar_* (应收)              │   │   │  • fbm_* (票据)             │                │
│   │  • ap_* (应付)              │   │   │  • cdmc_* (贷款)            │                │
│   │  • arap_* (核销/计提)       │   │   │  • ccc_* (授信)             │                │
│   │  • sscivm_* (发票)          │   │   │  • gpmc_* (担保)            │                │
│   │  • gl_* (对账)              │   │   │  • bgm_* (保函)             │                │
│   │  • org_* (组织)             │   │   │  • tam_* (账户)             │                │
│   └─────────────────────────────┘   │   └─────────────────────────────┘                │
│                                     │                                                   │
└─────────────────────────────────────┴───────────────────────────────────────────────────┘
```

---

## 六、核心数据表分布图

```
                                    218张数据表分布

    ┌────────────────────────────────────────────────────────────────────────┐
    │                                                                        │
    │                         司库特有数据 (151张, 69.3%)                      │
    │                                                                        │
    │   票据管理        贷款管理        授信管理        担保管理               │
    │   ████████       ██████████      ████            █████                 │
    │    36张           44张            17张            20张                  │
    │   (16.5%)        (20.2%)         (7.8%)          (9.2%)                │
    │                                                                        │
    │   保函管理        账户管理        债券/融资       其他业务               │
    │   ██              ████           ███             ███                   │
    │    6张            12张            7张             9张                   │
    │   (2.8%)          (5.5%)         (3.2%)          (4.1%)                │
    │                                                                        │
    └────────────────────────────────────────────────────────────────────────┘

    ┌────────────────────────────────────────────────────────────────────────┐
    │                                                                        │
    │                         公共数据 (67张, 30.7%)                          │
    │                                                                        │
    │   应收应付        坏账计提        发票管理        银行对账               │
    │   ███████        ████            ████            ███                   │
    │    23张           9张             9张             8张                   │
    │   (10.6%)        (4.1%)          (4.1%)          (3.7%)                │
    │                                                                        │
    │   组织配置        支付结算        其他公共                               │
    │   ███             ██              ███                                  │
    │    7张            5张             6张                                   │
    │   (3.2%)          (2.3%)         (2.8%)                                │
    │                                                                        │
    └────────────────────────────────────────────────────────────────────────┘


    图例说明:
    ████████  每个█约代表3张表

    处理平台:
    ┌──────────────────────────────────────────────────────────────┐
    │  司库特有数据 → 业务中台处理 (Flink实时 + 业务规则引擎)        │
    │  公共数据     → 数据湖处理   (Spark批处理 + 数据仓库分层)      │
    └──────────────────────────────────────────────────────────────┘
```

---

## 七、关键指标计算分工图

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                         │
│                                 关键指标计算分工                                          │
│                                                                                         │
├─────────────────────────────────────┬───────────────────────────────────────────────────┤
│                                     │                                                   │
│         数据湖计算指标               │          业务中台计算指标                          │
│                                     │                                                   │
├─────────────────────────────────────┼───────────────────────────────────────────────────┤
│                                     │                                                   │
│   财务类指标                         │   业务类指标                                       │
│   ──────────                        │   ──────────                                      │
│   • 应收账款周转率                   │   • 票据持有余额                                   │
│   • 应付账款周转率                   │   • 贷款未还本金                                   │
│   • 坏账率                          │   • 授信使用率                                     │
│   • 账龄分布                        │   • 担保敞口                                       │
│   • 发票匹配率                      │   • 保函在途金额                                   │
│                                     │                                                   │
│   对账类指标                         │   风险类指标                                       │
│   ──────────                        │   ──────────                                      │
│   • 银企对账差异                     │   • 逾期贷款率                                     │
│   • 余额调节率                      │   • 额度预警                                       │
│   • 未达账项                        │   • 到期预警                                       │
│                                     │   • 集中度风险                                     │
│                                     │                                                   │
│   统计类指标                         │   实时类指标                                       │
│   ──────────                        │   ──────────                                      │
│   • 日均余额                        │   • 实时可用额度                                   │
│   • 月发生额                        │   • 实时持票金额                                   │
│   • 同比/环比                       │   • 实时贷款余额                                   │
│                                     │   • 实时担保余额                                   │
│                                     │                                                   │
│   计算时效: T+1                      │   计算时效: 秒级/分钟级                            │
│   计算引擎: Spark                    │   计算引擎: Flink                                 │
│                                     │                                                   │
└─────────────────────────────────────┴───────────────────────────────────────────────────┘
```

---

文件已保存至：`/Users/fanxinming/Documents/Claude/claude-custom-log/司库数据架构总览.md`
